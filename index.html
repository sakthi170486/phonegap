<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Navigator</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="css/bootstrap.css">
		<script src="css/source-sans-pro.js"></script>
	</head>
	<body>
		<div class="maincontent">
		</div>
		<script id="home-tpl" type="text/x-handlebars-template">
			<div class="jumbotron text-center">
				<h1>Welcome to Navigator</h1>
				<p>Maintain the customer details!</p> 
			</div>
			<div class="container">
				<div class="row">
					<div class="col-md-4 d-none d-md-block">
					</div>
					<div class="col-md-4 col-sm-12">
						<div class="bg-color">
						<a class="d-block m-3 pt-3 text-white lnk" href="SignUp"><h4><i class="fa fa-plane"></i> Sign Up</h4></a>
						<a class="d-block m-3 pt-3 text-white lnk" href="SignIn"><h4><i class="fa fa-lock"></i> Sign In</h4></a>
						<a class="d-block m-3 pt-3 text-white lnk" href=""><h4><i class="fa fa-video-camera"></i> Watch Video</h4></a>
						</div>
					</div>
					<div class="col-md-4">
					</div>
				</div>
			</div>
		</script>
		<script id="signup-tpl" type="text/x-handlebars-template">
			<div class="container h-100 mt-3">
				<div class="h-100 row align-items-center">
					<div class="col-md-4 d-none d-md-block">
					</div>
					<div class="col-md-4 col-sm-12  mx-auto">
						<div class="bg-color">
							<h3 class="text-center text-white">SIGN UP</h3>
							<div class="form-group cam text-center text-white">
								<a href="" data-toggle="modal" data-target="#photo"><img src="img/camera.png" id='profimg' class="img-responsive"></a><br/>
								<span>upload photo</span><br/>
								<hr/>
							</div>
							<div id="photo" class="modal fade" role="dialog">
								<div class="modal-dialog">
									<div class="modal-content">
										<div class="modal-header">
											<p class="modal-title text-center w-100 font-weight-bold">Upload Photo</p>
											<span class="close" data-dismiss="modal">&times;</span>
											
										</div>
										<div class="modal-body text-center">
											<button id='but_take' class="btn btn-outline-primary">Take photo</button><br/>
											<button id='but_select' class="btn btn-outline-info mt-1">Select photo from Gallery</button>
											
										</div>
									</div>
								</div>	
							</div>
							<form action="#" class="text-white" name="reg" id="reg">
								<div class="form-group">
									<input type="text" class="form-control" required placeholder="Company Name *" name="cname" id="cname">
								</div>
								<div class="form-group">
									<input type="text" class="form-control" required placeholder="Your Name *" name="name" id="name">
								</div>
								<div class="form-group">
									<input type="tel" class="form-control" required placeholder="Mobile Number *" name="mobile" id="mobile">
								</div>
								<div class="form-group">
									<input type="tel" class="form-control" placeholder="Alternative Number" name="altmobile" id="altmobile">
								</div>
								<div class="form-group">
									<input type="email" class="form-control" placeholder="Email address *" required name="email" id="email">
								</div>	
								<div class="form-group text-center">
								<a id="" href="Home" class="btn form-btn pt-3 lnk">Home</a>
								<button type="submit" class="btn form-btn reg" name="insert" id="insert" >Submit</button>
								</div>
							</form>				
						</div>
					</div>
					<div class="col-md-4">
					</div>
				</div>
			</div>
		</script>
		<script id="signin-tpl" type="text/x-handlebars-template">
			<div class="container h-100 mt-3">
				<div class="h-100 row align-items-center">
					<div class="col-md-4 d-none d-md-block">
					</div>
					<div class="col-md-4 col-sm-12 mx-auto">
						<div class="bg-color">
							<h3 class="text-center text-white">SIGN IN</h3><br/>
							<form action="#" class="text-white">								
								<div class="form-group">
									<label for="mobile">Enter Mobile Number: *</label>
									<input type="tel" class="form-control" required id="umobile">
								</div>									
								<div class="form-group text-center">
								<a id="" href="Home" class="btn form-btn pt-3 lnk">Home</a>
								<button type="submit" class="btn form-btn lgn">Login</button>
								</div>
							</form>				
						</div>
					</div>
					<div class="col-md-4">
					</div>
				</div>
			</div>
		</script>
		<script id="otp-tpl" type="text/x-handlebars-template">
			<div class="container h-100 mt-3">
				<div class="h-100 row align-items-center">
					<div class="col-md-4 d-none d-md-block">
					</div>
					<div class="col-md-4 col-sm-12 mx-auto">
						<div class="bg-color">
							<h3 class="text-center text-white">SIGN IN</h3><br/>
							<form action="#" class="text-white">								
								<div class="form-group">
									<label for="mobile">Enter OTP: *</label>
									<input type="text" class="form-control" required id="otp">
								</div>									
								<div class="form-group text-center">
								<a id="" href="Home" class="btn form-btn pt-3 lnk">Home</a>
								<button type="submit" class="btn form-btn lgnotp">Submit</button>
								</div>
							</form>				
						</div>
					</div>
					<div class="col-md-4">
					</div>
				</div>
			</div>
		</script>
		
		<script id="employee-tpl" type="text/x-handlebars-template">
			<div class='header'><a href='#' class="button header-button header-button-left">Back</a><h1>Details</h1></div>
			<div class='details'>
			<img id='image' src='img/{{firstName}}_{{lastName}}.jpg' style="float:left;margin:10px;"/>
			<h1>{{firstName}} {{lastName}}</h1>
			<h2>{{title}}</h2>
			<span class="location"></span>
			<ul>
			<li><a href="tel:{{officePhone}}">Call Office<br/>{{officePhone}}</a></li>
			<li><a href="tel:{{cellPhone}}">Call Cell<br/>{{cellPhone}}</a></li>
			<li><a href="sms:{{cellPhone}}">SMS<br/>{{cellPhone}}</a></li>
			<li><a href="#" class="add-location-btn">Add Location</a></li>
			<li><a href="#" class="add-contact-btn">Add to Contacts</a></li>
			<li><a href="#" class="change-pic-btn">Change Picture</a></li>
			</ul>
			</div>
		</script>
	</body>
	<script src="phonegap.js"></script>
	<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
	<script src="js/jquery.min.js"></script>
	<script src="js/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>	
	<script src="lib/handlebars.js"></script>
	<!-- <script src="js/home.js"></script>
	<script src="js/signup.js"></script>-->
	<script src="js/main.js"></script> 
	<script type="text/javascript">
		// Change image source and upload photo to server
		function onSuccess(imageURI) {
			// Set image source
			var image = document.getElementById('profimg');
			image.src = imageURI  + '?' + Math.random();

			var options = new FileUploadOptions();
			options.fileKey = "file";
			options.fileName = imageURI.substr(imageURI.lastIndexOf('/') + 1);
			options.mimeType = "image/jpeg";

			var params = {};
			params.value1 = "test";
			params.value2 = "param";

			options.params = params;
			options.chunkedMode = false;

			var ft = new FileTransfer();
			ft.upload(imageURI, "http://www.azillesoft.com/phonegap/upload.php", function(result){
				alert('successfully uploaded ' + result.response);
			}, function(error){
				alert('error : ' + JSON.stringify(error));
			}, options);
		}
		function onFail(message) {
			alert('Failed because: ' + message);
		}
	$(function()
	{
		$('body').on('click','.lnk',function(e){
			e.preventDefault();
			var l=$(this).attr('href').toLowerCase();
			var template = Handlebars.compile($("#"+l+"-tpl").html());	
			$('.maincontent').html(template);
		});
		$("body").on('blur','#mobile',function(e){
			var v=$(this).val();
			if(v.length > 0)
			{
				$.ajax({
					type: "POST",
					url:"http://www.azillesoft.com/phonegap/database/checkumobile.php",
					data : 'm='+v, // post data || get data
					crossDomain: true,
					cache: false,
					success: function(data){
						if(data == "exists")
						{
							alert("Mobile number already registered.");
							$("#mobile").val('');
							$("#reg")[0].reset();
							var signinTpl = Handlebars.compile($("#signin-tpl").html());	
							$('.maincontent').html(signinTpl);							
						}						
					}
				});
			}
		});
	
		// take picture from camera
		$('body').on('click','#but_take',function(){
			navigator.camera.getPicture(onSuccess, onFail, { quality: 20,
				destinationType: Camera.DestinationType.FILE_URL 
			});
		});

		// upload select 
		$('body').on('click','#but_select',function(){
			navigator.camera.getPicture(onSuccess, onFail, { quality: 50,
				sourceType: Camera.PictureSourceType.PHOTOLIBRARY, 
				allowEdit: true,
				destinationType: Camera.DestinationType.FILE_URI
			});
		});

           
		$("body").on('click','#insert',function(e){
			e.preventDefault();	
			var cname=$("#cname").val();
			var name=$("#name").val();
			var mobile=$("#mobile").val();
			var amobile=$("#altmobile").val();
			var email=$("#email").val();			
			if($.trim(cname).length > 0 && $.trim(name).length > 0 && $.trim(mobile).length > 0 && $.trim(email).length > 0)
			{				
				 atpos = email.indexOf("@");
				 dotpos = email.lastIndexOf(".");				 
				 if (atpos < 1 || ( dotpos - atpos < 2 )) {
					alert("Please enter correct email ID")
					$("#email").focus() ;
					return false;
				 }
				 if(isNaN( mobile ) ||$.trim(mobile).length != 10 ) {					
					alert( "Please provide a valid mobile number." );
					$("#mobile").focus() ;
					return false;
				 }
				  if( amobile != '' && $.trim(amobile).length != 10 ) {					
					alert( "Please provide a valid alternate number." );
					$("#altmobile").focus() ;
					return false;
				 }		
			
				$.ajax({
					type: "POST",
					url:"http://www.azillesoft.com/phonegap/database/insert.php",
					//dataType : 'json', // data type
					data : $("#reg").serialize(), // post data || get data
					crossDomain: true,
					cache: false,
					beforeSend: function(){ $("#insert").text('Connecting...');},
					success: function(data){
						if(data=="success")
						{
							alert("inserted");
							$("#insert").text('Submit');
							$("#reg")[0].reset();
							var signinTpl = Handlebars.compile($("#signin-tpl").html());	
							$('.maincontent').html(signinTpl);
							
						}
						else if(data=="error")
						{
							alert("error");
							//$("#reg")[0].reset();
						}
					}
				});
			}
			else 
			{
				alert("Enter all the required fields");
				//$("#reg")[0].reset();
			}
			return false;
		});
	});
 </script>
</html>